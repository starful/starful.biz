{% extends "base.html" %}

{% block head %}
<title>{{ item.title }} | Starful</title>
<meta name="description" content="{{ item.meta_description }}">
{% endblock %}

{% block content %}
<main style="width: 100%;">
    <!-- 1. 히어로 섹션 (짤림 방지 적용) -->
    <header style="background: #fff; border-bottom: 1px solid #eee; padding: 80px 0 40px;">
        <div style="max-width: 780px; margin: 0 auto; padding: 0 20px;">
            <span style="color: var(--accent); font-weight: 800; font-size: 0.9rem; display: block; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">
                {{ category_title }} GUIDE
            </span>
            <h1 style="font-size: clamp(1.8rem, 7vw, 3.2rem); font-weight: 800; line-height: 1.25; margin: 0; color: #1d1d1f;">
                {{ item.title }}
            </h1>
            <p style="color: #666; font-size: 1.2rem; margin-top: 25px; line-height: 1.6; font-weight: 400;">
                {{ item.meta_description }}
            </p>
        </div>
    </header>

    <div class="detail-body">
        <!-- 2. 상단 광고 슬롯 (너비 강제 확보) -->
        <div class="ad-slot">
            <ins class="adsbygoogle"
                 style="display:block; width:100%;"
                 data-ad-layout="in-article"
                 data-ad-format="fluid"
                 data-ad-client="ca-pub-8780435268193938"
                 data-ad-slot="3923725999"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 3. 핵심 요약 카드 -->
        <div style="background: #f9f9fb; border-radius: 20px; padding: 30px; margin: 40px 0; border: 1px solid #efeff4;">
            <h3 style="margin-top:0; font-size: 1.3rem; font-weight: 800;">
                <i class="fa-solid fa-bolt" style="color: #ffcc00; margin-right: 8px;"></i> ク이ックサ마리
            </h3>
            <ul style="list-style: none; padding: 0; margin: 20px 0 0;">
                <li style="display: flex; gap: 10px; margin-bottom: 12px;">
                    <i class="fa-solid fa-circle-check" style="color:var(--accent); margin-top:5px;"></i>
                    <span><strong>ミッション:</strong> {{ item.title }}의 핵심 역할과 기술적 가치</span>
                </li>
                <li style="display: flex; gap: 10px;">
                    <i class="fa-solid fa-circle-check" style="color:var(--accent); margin-top:5px;"></i>
                    <span><strong>将来性:</strong> 지속적인 수요와 커리어 확장 가능성</span>
                </li>
            </ul>
        </div>

        <!-- 4. 마크다운 본문 (JS로 표 짤림 방지 처리됨) -->
        <article id="content-main">
            {{ content | safe }}
        </article>

        <!-- 5. 하단 광고 슬롯 -->
        <div class="ad-slot">
            <ins class="adsbygoogle"
                 style="display:block; width:100%;"
                 data-ad-format="autorelaxed"
                 data-ad-client="ca-pub-8780435268193938"
                 data-ad-slot="3923725999"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 6. 관련 직업 추천 -->
        <section style="margin-top: 100px;">
            <h3 style="font-size: 1.8rem; font-weight: 800; margin-bottom: 40px; border-left: 6px solid var(--accent); padding-left: 20px;">
                関連性の高いキャリア
            </h3>
            <div class="main-grid">
                {% for job in related_jobs_data %}
                <a href="/career/{{ job.id }}" class="content-card" style="height: 240px;">
                    <div class="card-bg">
                        <img src="{{ job.thumbnail }}" onerror="this.src='https://images.unsplash.com/photo-1516321318423-f06f85e504b3?q=80&w=800&auto=format&fit=crop'">
                    </div>
                    <div class="card-overlay"></div>
                    <div class="card-body">
                        <h3 style="font-size: 1.2rem;">{{ job.title }}</h3>
                    </div>
                </a>
                {% endfor %}
            </div>
        </section>
    </div>
</main>

<script>
/**
 * 마크다운에서 생성된 표(table)들이 화면을 뚫고 나가지 않도록 
 * 자동으로 스크롤 가능한 div로 감싸주는 스크립트입니다.
 */
document.addEventListener('DOMContentLoaded', function() {
    const tables = document.querySelectorAll('#content-main table');
    tables.forEach(table => {
        const wrapper = document.createElement('div');
        wrapper.className = 'table-wrapper';
        table.parentNode.insertBefore(wrapper, table);
        wrapper.appendChild(table);
    });
});
</script>
{% endblock %}