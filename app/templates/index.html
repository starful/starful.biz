{% extends "base.html" %}

{% block content %}
<header class="header">
    <div class="logo-area">
        <a href="/"><img src="/static/img/logo.png" alt="Starful" style="height: 50px; margin-bottom: 20px;" onerror="this.style.display='none'"></a>
    </div>
    <h1>理想のキャリアを、<br>もっとスマートに。</h1>
    <p>90以上の職種ガイドから、あなたに最適な道を見つけてください。</p>

    <!-- 통계 바 일본어화 -->
    <div class="stats-bar">
        <div class="stat-item"><span class="stat-label">職種ガイド</span><span class="stat-value">{{ total_count }}件</span></div>
        <div class="stat-divider"></div>
        <div class="stat-item"><span class="stat-label">最終更新日</span><span class="stat-value">{{ last_updated }}</span></div>
    </div>

    <!-- 카테고리 탭 필터 -->
    <div class="category-tabs-container">
        <div class="category-tabs">
            <button class="tab-btn active" data-filter="all">全て</button>
            {% for category in grouped_items %}
            <button class="tab-btn" data-filter="{{ category.slug }}">{{ category.title }}</button>
            {% endfor %}
        </div>
    </div>

    <div class="search-container">
        <form action="/search" method="GET">
            <input type="text" name="q" class="search-input" placeholder="職種、スキル、キーワードで検索...">
        </form>
    </div>
</header>

<div class="container">
    {% for category in grouped_items %}
        <section class="filter-section" id="section-{{ category.slug }}" style="margin-bottom: 60px;">
            <h2 style="font-size: 1.6rem; font-weight: 900; margin-bottom: 24px; display: flex; align-items: center; gap: 10px;">
                <span style="width: 5px; height: 25px; background: var(--accent); border-radius: 10px;"></span>
                {{ category.title }}
            </h2>
 
            <div class="main-grid">
                {% for item in category.job_items %}
                    {% if loop.index == 4 %}
                    <div class="ad-card">
                        <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-format="fluid"
                            data-ad-layout-key="-fb+5w+4e-db+86"
                            data-ad-client="ca-pub-8780435268193938"
                            data-ad-slot="3923725999"></ins>
                        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                    </div>
                    {% endif %}

                    <a href="/career/{{ item.id }}" class="content-card">
                        <div class="card-bg">
                            <img src="{{ item.thumbnail }}" 
                                alt="{{ item.title }}" 
                                onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?q=80&w=800&auto=format&fit=crop';">
                        </div>
                        <div class="card-overlay"></div>
                        <div class="card-body">
                            {% if item.tags %}<span class="category-tag">{{ item.tags[0] }}</span>{% endif %}
                            <h3>{{ item.title }}</h3>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </section>
    {% endfor %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tabs = document.querySelectorAll('.tab-btn');
    const sections = document.querySelectorAll('.filter-section');
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const filter = tab.getAttribute('data-filter');
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            sections.forEach(section => {
                if (filter === 'all' || section.id === 'section-' + filter) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
        });
    });
});
</script>
{% endblock %}